# Лабораторная работа. Настройка расширенных функций EIGRP для IPv4

### Топология



### Таблица адресации

| Устройство   | Интерфейс     | IP-адрес        | Маска подсети    | Шлюз по умолчанию |
| ------------ | ------------- | --------------- | ---------------- | ----------------- |
| R1           | G0/0          | 192.168.1.1     | 255.255.255.0    | —                 |
| S0/0/0 (DCE) | 192.168.12.1  | 255.255.255.252 | —                |                   |
| S0/0/1       | 192.168.13.1  | 255.255.255.252 | —                |                   |
| Lo1          | 192.168.11.1  | 255.255.255.252 | Н/Д (недоступно) |                   |
| Lo5          | 192.168.11.5  | 255.255.255.252 | —                |                   |
| Lo9          | 192.168.11.9  | 255.255.255.252 | —                |                   |
| Lo13         | 192.168.11.13 | 255.255.255.252 | —                |                   |
| R2           | G0/0          | 192.168.2.1     | 255.255.255.0    | —                 |
| S0/0/0       | 192.168.12.2  | 255.255.255.252 | —                |                   |
| S0/0/1 (DCE) | 192.168.23.1  | 255.255.255.252 | —                |                   |
| Lo1          | 192.168.22.1  | 255.255.255.252 | —                |                   |
| R3           | G0/0          | 192.168.3.1     | 255.255.255.0    | —                 |
| S0/0/0 (DCE) | 192.168.13.2  | 255.255.255.252 | —                |                   |
| S0/0/1       | 192.168.23.2  | 255.255.255.252 | —                |                   |
| Lo1          | 192.168.33.1  | 255.255.255.252 | Н/Д (недоступно) |                   |
| Lo5          | 192.168.33.5  | 255.255.255.252 | —                |                   |
| Lo9          | 192.168.33.9  | 255.255.255.252 | —                |                   |
| Lo13         | 192.168.33.13 | 255.255.255.252 | —                |                   |
| PC-A         | NIC           | 192.168.1.3     | 255.255.255.0    | 192.168.1.1       |
| PC-B         | NIC           | 192.168.2.3     | 255.255.255.0    | 192.168.2.1       |
| PC-C         | NIC           | 192.168.3.3     | 255.255.255.0    | 192.168.3.1       |


### Задачи

1. Создание сети и настройка основных параметров устройства

2. Настройка EIGRP и проверка подключения

3. Настройка EIGRP для автоматического объединения

4. Настройка и распространение статического маршрута по умолчанию

5. Выполнение точной настройки EIGRP

-   Настройте параметры использования пропускной способности для EIGRP.

-   Настройте интервал отправки пакетов приветствия (hello) и таймер удержания для EIGRP.

### Общие сведения/сценарий

EIGRP поддерживает расширенный набор функций, которые позволяют вносить изменения, связанные с объединением, распространением маршрута по умолчанию, использованием пропускной способности и показателями.

В этой лабораторной работе вам предстоит настроить автоматическое объединение для EIGRP, настроить распространение маршрута EIGRP и выполнить точную настройку показателей EIGRP.

**Примечание**. В практических лабораторных работах CCNA используются маршрутизаторы с интегрированными сетевыми сервисами (ISR) Cisco 1941 с операционной системой Cisco IOS версии 15.2(4)M3 (образ universalk9). Допускается использование маршрутизаторов других моделей, а также других версий операционной системы Cisco IOS. В зависимости от модели устройства и версии Cisco IOS доступные команды и результаты их выполнения могут отличаться от тех, которые показаны в лабораторных работах. Правильные идентификаторы интерфейса см. в сводной таблице по интерфейсам маршрутизаторов в конце лабораторной работы.

**Примечание**. Убедитесь, что предыдущие настройки маршрутизаторов удалены, и на них отсутствуют файлы загрузочной конфигурации. Если вы не уверены, обратитесь к инструктору.

### Необходимые ресурсы

-   3 маршрутизатора (Cisco 1941 с операционной системой Cisco IOS версии 15.2(4)M3 (универсальный образ) или аналогичная модель)

-   3 ПК (Windows и программа эмуляции терминалов, например Tera Term)

-   Консольные кабели для настройки устройств Cisco IOS через консольные порты

-   Кабели Ethernet и последовательные кабели согласно топологии

### 1. Создание сети и настройка основных параметров устройства

В части 1 вам предстоит настроить топологию сети и сделать базовую настройку устройств.

**1.1 Создайте сеть согласно топологии.**

**1.2 Настройте узлы ПК.**

**1.3 Выполните запуск и перезагрузку маршрутизаторов.**

**1.4 Произведите базовую настройку маршрутизаторов.**

Отключите DNS-поиск.

Настройте имена устройств в соответствии с топологией.

Назначьте **cisco** в качестве паролей консоли и VTY.

Назначьте **class** в качестве пароля доступа к привилегированному режиму EXEC.

Настройте **logging synchronous**, чтобы сообщения от консоли не могли прерывать ввод команд.

Назначьте IP-адреса всем интерфейсам в соответствии с таблицей адресации.

**Примечание**. На этот раз **НЕ** настраивайте интерфейсы обратной петли.

Скопируйте текущую конфигурацию в файл загрузочной конфигурации.

### 2. Настройка EIGRP и проверка подключения

В части 2 вам необходимо настроить базовые функции EIGRP для топологии и задать пропускную способность для последовательных интерфейсов.

**Примечание**. В этой лабораторной работе содержится минимальный набор команд, необходимых для настройки EIGRP. Список требуемых команд приведен в Приложении А. Проверьте свои знания: настройте устройства, не заглядывая в приложение.

**2.1 Настройте EIGRP.**

На маршрутизаторе R1 настройте маршрутизацию EIGRP с номером автономной системы (AS) 1 для всех сетей с прямым подключением. *Запишите использованные команды в поле ниже.*



Для интерфейса локальной сети маршрутизатора R1 отключите передачу пакетов приветствия (hello) EIGRP. *Ниже напишите команду, которую вы использовали.*



На маршрутизаторе R1 настройте пропускную способность для интерфейса S0/0/0 равной 1024 Кбит/с, а для интерфейса S0/0/1 равной 64 Кбит/с. *Запишите использованные команды в поле ниже.* **Примечание**. Команда **bandwidth** влияет только на вычисление показателя EIGRP, а не на фактическую пропускную способность последовательного канала связи.



На маршрутизаторе R2 настройте маршрутизацию EIGRP с идентификатором AS 1 для всех сетей, отключите передачу пакетов приветствия (hello) EIGRP для интерфейса локальной сети и задайте пропускную способность для интерфейса S0/0/0 равной 1024 Кбит/с.

На маршрутизаторе R3 настройте маршрутизацию EIGRP с идентификатором AS 1 для всех сетей, отключите передачу пакетов приветствия (hello) EIGRP для интерфейса локальной сети и задайте пропускную способность для интерфейса S0/0/0 равной 64 Кбит/с.

**2.2 Проверьте связь.**

Все компьютеры должны успешно отправлять эхо-запросы друг другу. При неудачном выполнении эхо-запросов выполните поиск и устранение неполадок.

**Примечание**. Для успешной передачи эхо-запросов может потребоваться отключение межсетевого экрана.

### 3. Настройка EIGRP для автоматического объединения

В части 3 вы добавите интерфейсы обратной петли и включите автоматическое объединение EIGRP на маршрутизаторах R1 и R3. Вы также пронаблюдаете за изменениями в таблице маршрутизации R2.

**3.1 Настройте EIGRP для автоматического объединения**.

Введите команду **show ip protocols** на R1. *Как по умолчанию настроено автоматическое объединение в EIGRP?*



Настройте loopback-адреса на R1.

Добавьте соответствующие инструкции network для процесса EIGRP на маршрутизаторе R1. *Запишите использованные команды в поле ниже.*



На маршрутизаторе R2 выполните команду **show ip route** **eigrp**. *Как сети loopback представлены в результатах этой команды?*



На маршрутизаторе R1 выполните команду **auto-summary** в рамках процесса EIGRP.

```
R1(config)\# router eigrp 1

R1(config-router)\# auto-summary

R1(config-router)\#

\*Apr 14 01:14:55.463: %DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 192.168.13.2 (Serial0/0/1) is resync: summary configured

\*Apr 14 01:14:55.463: %DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 192.168.12.2 (Serial0/0/0) is resync: summary configured

\*Apr 14 01:14:55.463: %DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 192.168.13.2 (Serial0/0/1) is resync: summary up, remove components

R1(config-router)\#67: %DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 192.168.12.2 (Serial0/0/0) is resync: summary up, remove components

\*Apr 14 01:14:55.467: %DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 192.168.12.2 (Serial0/0/0) is resync: summary up, remove components

\*Apr 14 01:14:55.467: %DUAL-5-NBRCHANGE: EIGRP-IPv4 1: Neighbor 192.168.13.2 (Serial0/0/1) is resync: summary up, remove components
```

*Как изменилась таблица маршрутизации на R2?*



Повторите подшаги, добавив интерфейсы обратной петли, сети процесса EIGRP и автоматическое объединение на маршрутизаторе R3.

### 4. Настройка и распространение статического маршрута по умолчанию

В части 4 вам необходимо настроить статический маршрут по умолчанию на R2 и распространить его на все остальные маршрутизаторы.

Настройте loopback-адрес на R2.

Настройте статический маршрут по умолчанию с выходным интерфейсом Lo1.

```
R2(config)\# ip route 0.0.0.0 0.0.0.0 Lo1
```

cВыполните команду **redistribute static** в рамках процесса EIGRP, чтобы распространить статический маршрут по умолчанию на другие участвующие маршрутизаторы.

```
R2(config)\# router eigrp 1

R2(config-router)\# redistribute static
```

Используйте команду **show ip protocols** на маршрутизаторе R2, чтобы проверить, распространился ли этот статический маршрут.

```
R2\# show ip protocols

\*\*\* IP Routing is NSF aware \*\*\*

\<выходные данные опущены\>

Routing Protocol is \"eigrp 1\"

Outgoing update filter list for all interfaces is not set

Incoming update filter list for all interfaces is not set

Default networks flagged in outgoing updates

Default networks accepted from incoming updates

Redistributing: static

EIGRP-IPv4 Protocol for AS(1)

Metric weight K1=1, K2=0, K3=1, K4=0, K5=0

NSF-aware route hold timer is 240

Router-ID: 192.168.23.1

Topology : 0 (base)

Active Timer: 3 min

Distance: internal 90 external 170

Maximum path: 4

Maximum hopcount 100

Maximum metric variance 1

Automatic Summarization: disabled

Maximum path: 4

Routing for Networks:

192.168.2.0

192.168.12.0/30

192.168.23.0/30

Passive Interface(s):

GigabitEthernet0/0

Routing Information Sources:

Gateway Distance Last Update

192.168.12.1 90 00:13:20

192.168.23.2 90 00:13:20

Distance: internal 90 external 170
```

На маршрутизаторе R1 выполните команду **show ip route eigrp** **\| include 0.0.0.0**, чтобы просмотреть инструкции, относящиеся к маршруту по умолчанию. *Как статический маршрут по умолчанию представлен в результатах этой команды? Укажите административную дистанцию (AD) распространяемого маршрута.*



### 5. Подгонка EIGRP

В части 5 вам предстоит настроить процент пропускной способности, который может быть использован интерфейсом для трафика EIGRP, а также изменить интервал приветствия и таймеры удержания для интерфейсов EIGRP.

**5.1 Настройте параметры использования пропускной способности для EIGRP.**

Настройте последовательный канал между маршрутизаторами R1 и R2, чтобы разрешить трафику EIGRP использовать только 75 % пропускной способности канала.

```
R1(config)\# interface s0/0/0

R1(config-if)\# ip bandwidth-percent eigrp 1 75

R2(config)\# interface s0/0/0

R2(config-if)\# ip bandwidth-percent eigrp 1 75
```

Настройте последовательный канал между маршрутизаторами R1 и R3, чтобы разрешить трафику EIGRP использовать только 40 % пропускной способности канала.

**5.2 Настройте интервал отправки пакетов приветствия (hello) и таймер удержания для EIGRP.**

На маршрутизаторе R2 используйте команду **show ip eigrp interfaces** **detail** для просмотра интервала приветствия и таймера задержки для EIGRP.

```
R2\# show ip eigrp interfaces detail

EIGRP-IPv4 Interfaces for AS(1)

Xmit Queue PeerQ Mean Pacing Time Multicast Pending

Interface Peers Un/Reliable Un/Reliable SRTT Un/Reliable Flow Timer Routes

Se0/0/0 1 0/0 0/0 1 0/15 50 0

Hello-interval is 5, Hold-time is 15

Split-horizon is enabled

Next xmit serial \<none\>

Packetized sent/expedited: 29/1

Hello\'s sent/expedited: 390/2

Un/reliable mcasts: 0/0 Un/reliable ucasts: 35/39

Mcast exceptions: 0 CR packets: 0 ACKs suppressed: 0

Retransmissions sent: 0 Out-of-sequence rcvd: 0

Topology-ids on interface - 0

Interface BW percentage is 75

Authentication mode is not set

Se0/0/1 1 0/0 0/0 1 0/16 50 0

Hello-interval is 5, Hold-time is 15

Split-horizon is enabled

Next xmit serial \<none\>

Packetized sent/expedited: 34/5

Hello\'s sent/expedited: 382/2

Un/reliable mcasts: 0/0 Un/reliable ucasts: 31/42

Mcast exceptions: 0 CR packets: 0 ACKs suppressed: 2

Retransmissions sent: 0 Out-of-sequence rcvd: 0

Topology-ids on interface - 0

Authentication mode is not set
```

*Укажите значение таймера приветствия по умолчанию.*



*Укажите значение таймера удержания по умолчанию.*



Для интерфейсов S0/0/0 и S0/0/1 маршрутизатора R1 настройте интервал приветствия равным 60 секунд, а таймер удержания равным 180 секунд, именно в этом порядке.

```
R1(config)\# interface s0/0/0

R1(config-if)\# ip hello-interval eigrp 1 60

R1(config-if)\# ip hold-time eigrp 1 180

R1(config)\# interface s0/0/1

R1(config-if)\# ip hello-interval eigrp 1 60

R1(config-if)\# ip hold-time eigrp 1 180
```

Для последовательных интерфейсах маршрутизаторов R2 и R3 настройте интервал приветствия равным 60 секунд, а таймер удержания равным 180 секунд.

### Вопросы для повторения

*В чем заключаются преимущества объединения маршрутов?*



*Почему при настройке таймеров EIGRP необходимо настраивать значение времени удержания равным или больше интервала приветствия?*

​                                                                                

### Приложение А. Команды конфигурации

**Маршрутизатор R1**

```
R1(config)\# router eigrp 1

R1(config-router)\# network 192.168.1.0

R1(config-router)\# network 192.168.12.0 0.0.0.3

R1(config-router)\# network 192.168.13.0 0.0.0.3

R1(config-router)\# network 192.168.11.0 0.0.0.3

R1(config-router)\# network 192.168.11.4 0.0.0.3

R1(config-router)\# network 192.168.11.8 0.0.0.3

R1(config-router)\# network 192.168.11.12 0.0.0.3

R1(config-router)\# passive-interface g0/0

R1(config-router)\# auto-summary

R1(config)\# int s0/0/0

R1(config-if)\# bandwidth 1024

R1(config-if)\# ip bandwidth-percent eigrp 1 75

R1(config-if)\# ip hello-interval eigrp 1 60

R1(config-if)\# ip hold-time eigrp 1 180

R1(config-if)\# int s0/0/1

R1(config-if)\# bandwidth 64

R1(config-if)\# ip bandwidth-percent eigrp 1 40

R1(config-if)\# ip hello-interval eigrp 1 60

R1(config-if)\# ip hold-time eigrp 1 180
```

**Маршрутизатор R2**

```
R2(config)\# router eigrp 1

R2(config-router)\# network 192.168.2.0

R2(config-router)\# network 192.168.12.0 0.0.0.3

R2(config-router)\# network 192.168.23.0 0.0.0.3

R2(config-router)\# passive-interface g0/0

R2(config-router)\# redistribute static

R2(config)\# int s0/0/0

R2(config-if)\# bandwidth 1024

R2(config-if)\# ip bandwidth-percent eigrp 1 75

R2(config-if)\# ip hello-interval eigrp 1 60

R2(config-if)\# ip hold-time eigrp 1 180

R2(config-if)\# int s0/0/1

R2(config-if)\# ip hello-interval eigrp 1 60

R2(config-if)\# ip hold-time eigrp 1 180
```

**Маршрутизатор R3**

```
R3(config)\# router eigrp 1

R3(config-router)\# network 192.168.3.0

R3(config-router)\# network 192.168.13.0 0.0.0.3

R3(config-router)\# network 192.168.23.0 0.0.0.3

R3(config-router)\# network 192.168.33.0 0.0.0.3

R3(config-router)\# network 192.168.33.4 0.0.0.3

R3(config-router)\# network 192.168.33.8 0.0.0.3

R3(config-router)\# network 192.168.33.12 0.0.0.3

R3(config-router)\# passive-interface g0/0

R3(config-router)\# auto-summary

R3(config)\# int s0/0/0

R3(config-if)\# bandwidth 64

R3(config-if)\# ip bandwidth-percent eigrp 1 40

R3(config-if)\# ip hello-interval eigrp 1 60

R3(config-if)\# ip hold-time eigrp 1 180

R3(config-if)\# int s0/0/1

R3(config-if)\# ip hello-interval eigrp 1 60

R3(config-if)\# ip hold-time eigrp 1 180
```

